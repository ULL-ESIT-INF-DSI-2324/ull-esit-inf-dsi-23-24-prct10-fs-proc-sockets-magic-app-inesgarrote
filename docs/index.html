<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote</title><meta name="description" content="Documentation for ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote</h2></div><div class="tsd-panel tsd-typography"><p><a href="https://classroom.github.com/a/7bX30zK4"><img src="https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg" alt="Review Assignment Due Date"></a></p>
<a id="md:práctica-10---aplicación-cliente-servidor-para-coleccionistas-de-cartas-magic" class="tsd-anchor"></a><h1><a href="#md:práctica-10---aplicación-cliente-servidor-para-coleccionistas-de-cartas-magic">Práctica 10 - Aplicación cliente-servidor para coleccionistas de cartas Magic</a></h1><p>Realizada por Inés Garrote Fontenla <a href="alu0101512297@ull.edu.es">alu0101512297@ull.edu.es</a><br>Enlace al repositorio de Github asociado a la práctica <a href="https://github.com/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote.git">ull-esit-inf-dsi-23-24-prct10-vscode-inesgarrote</a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote/actions/workflows/node.js.yml/badge.svg" alt="Tests"></a></p>
<p><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote/badge.svg?branch=main" alt="Coverage Status"></a></p>
<p><a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote&metric=bugs" alt="Bugs"></a></p>
<a id="md:introducción" class="tsd-anchor"></a><h1><a href="#md:introducción">Introducción</a></h1><p>En esta práctica, se aborda la implementación de una aplicación cliente-servidor para coleccionistas de cartas Magic, extendiendo el trabajo realizado en la Práctica 9. Se desarrolla un servidor y un cliente utilizando sockets proporcionados por el módulo net de Node.js. Los usuarios interactúan exclusivamente con el cliente a través de la línea de comandos, mientras que el servidor gestiona las operaciones sobre las cartas almacenadas en ficheros JSON en el sistema de ficheros.</p>
<p>Se adopta una metodología de desarrollo dirigido por pruebas/comportamiento (TDD/BDD), asegurando el correcto funcionamiento del código y la robustez ante entradas no válidas. Se siguen los principios SOLID de diseño orientado a objetos para garantizar la modularidad y mantenibilidad del código.</p>
<p>Se incluyen flujos de trabajo de GitHub Actions para realizar pruebas en diferentes entornos con distintas versiones de Node.js, enviar datos de cobertura a Coveralls y realizar análisis de calidad y seguridad del código fuente a través de Sonar Cloud.</p>
<ul>
<li>Se hace uso de los paquetes yargs y chalk, similares a la Práctica 9.</li>
<li>Se emplea la clase EventEmitter del módulo Events de Node.js para manejar eventos.</li>
<li>Se utiliza el módulo fs de Node.js para operaciones de sistema de ficheros.</li>
<li>Se implementa el módulo net de Node.js para la comunicación entre cliente y servidor.</li>
</ul>
<a id="md:desarrollo" class="tsd-anchor"></a><h1><a href="#md:desarrollo">Desarrollo</a></h1><p>La aplicación debe permitir la interacción simultánea de múltiples usuarios, cada uno con su propia colección de cartas. Se especifican las operaciones básicas sobre las cartas, como añadir, modificar, eliminar, listar y mostrar información detallada de una carta. Las cartas se describen mediante varios atributos, incluyendo ID, nombre, coste de maná, color, tipo, rareza, texto de reglas, etc.</p>
<a id="md:consideraciones-de-implementación" class="tsd-anchor"></a><h2><a href="#md:consideraciones-de-implementación">Consideraciones de Implementación:</a></h2><ol>
<li>Se emplea el patrón petición-respuesta, donde el cliente envía una petición al servidor, el servidor procesa la petición, envía una respuesta y luego cierra la conexión.</li>
<li>Todos los mensajes intercambiados entre cliente y servidor son representaciones JSON válidas.</li>
<li>La lógica relacionada con el sistema de ficheros reside en el servidor y se basa en el uso del API asíncrona de Node.js.</li>
<li>El cliente se encarga del procesamiento de los argumentos de línea de comandos utilizando el paquete yargs.</li>
<li>Se implementan pruebas unitarias para verificar el correcto funcionamiento del código y para manejar entradas no válidas o inesperadas.</li>
</ol>
<p>Para realizar lo anterior, en primer lugar se modicaron los métodos de la clase Usuario, para que implementasen el patrón de CallBack. Por ejemplo, aqui tenemos el metodo modificar carta:</p>
<pre><code class="language-typescript"><span class="hl-0">   </span><span class="hl-1">/**</span><br/><span class="hl-1">   * </span><span class="hl-2">@brief</span><span class="hl-1"> Método que modifica una carta de la colección del usuario.</span><br/><span class="hl-1">   * </span><span class="hl-2">@param</span><span class="hl-1"> </span><span class="hl-3">id</span><br/><span class="hl-1">   * </span><span class="hl-2">@param</span><span class="hl-1"> </span><span class="hl-3">nuevaCarta</span><br/><span class="hl-1">   * </span><span class="hl-2">@param</span><span class="hl-1"> </span><span class="hl-3">callback</span><br/><span class="hl-1">   * </span><span class="hl-2">@returns</span><br/><span class="hl-1">   */</span><br/><span class="hl-0">  </span><span class="hl-3">public</span><span class="hl-0"> </span><span class="hl-4">modificarCarta</span><span class="hl-0">(</span><br/><span class="hl-0">    </span><span class="hl-3">id</span><span class="hl-0">: </span><span class="hl-3">number</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-3">nuevaCarta</span><span class="hl-0">: </span><span class="hl-3">Carta</span><span class="hl-0">,</span><br/><span class="hl-0">    </span><span class="hl-3">callback</span><span class="hl-0">: (</span><span class="hl-3">error</span><span class="hl-0">: </span><span class="hl-5">Error</span><span class="hl-0"> | </span><span class="hl-5">null</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> </span><span class="hl-2">void</span><span class="hl-0">,</span><br/><span class="hl-0">  ): </span><span class="hl-2">void</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">this</span><span class="hl-0">.</span><span class="hl-4">cargarColeccion</span><span class="hl-0">((</span><span class="hl-3">error</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">      </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-3">error</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-4">callback</span><span class="hl-0">(</span><span class="hl-3">error</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-6">return</span><span class="hl-0">;</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">index</span><span class="hl-0"> = </span><span class="hl-2">this</span><span class="hl-0">.</span><span class="hl-3">coleccion</span><span class="hl-0">.</span><span class="hl-4">findIndex</span><span class="hl-0">((</span><span class="hl-3">c</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> </span><span class="hl-3">c</span><span class="hl-0">.</span><span class="hl-3">id</span><span class="hl-0"> === </span><span class="hl-3">id</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-3">index</span><span class="hl-0"> === -</span><span class="hl-8">1</span><span class="hl-0">) {</span><br/><span class="hl-0">        </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">notFoundError</span><span class="hl-0"> = </span><span class="hl-2">new</span><span class="hl-0"> </span><span class="hl-4">Error</span><span class="hl-0">(</span><br/><span class="hl-0">          </span><span class="hl-9">&quot;¡Error! No se encontró ninguna carta con ese ID en la colección.&quot;</span><span class="hl-0">,</span><br/><span class="hl-0">        );</span><br/><span class="hl-0">        </span><span class="hl-4">callback</span><span class="hl-0">(</span><span class="hl-3">notFoundError</span><span class="hl-0">);</span><br/><span class="hl-0">        </span><span class="hl-6">return</span><span class="hl-0">;</span><br/><span class="hl-0">      }</span><br/><span class="hl-0">      </span><span class="hl-2">this</span><span class="hl-0">.</span><span class="hl-3">coleccion</span><span class="hl-0">[</span><span class="hl-3">index</span><span class="hl-0">] = </span><span class="hl-3">nuevaCarta</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-2">this</span><span class="hl-0">.</span><span class="hl-4">guardarColeccion</span><span class="hl-0">((</span><span class="hl-3">error</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">        </span><span class="hl-6">if</span><span class="hl-0"> (</span><span class="hl-3">error</span><span class="hl-0">) {</span><br/><span class="hl-0">          </span><span class="hl-4">callback</span><span class="hl-0">(</span><span class="hl-3">error</span><span class="hl-0">);</span><br/><span class="hl-0">          </span><span class="hl-6">return</span><span class="hl-0">;</span><br/><span class="hl-0">        }</span><br/><span class="hl-0">        </span><span class="hl-4">callback</span><span class="hl-0">(</span><span class="hl-2">null</span><span class="hl-0">);</span><br/><span class="hl-0">      });</span><br/><span class="hl-0">    });</span><br/><span class="hl-0">  }</span>
</code><button>Copy</button></pre>
<p><strong>Parámetros de la función</strong>: La función modificarCarta recibe tres parámetros:</p>
<ul>
<li>id: El identificador de la carta que se desea modificar.</li>
<li>nuevaCarta: La nueva información de la carta que se utilizará para actualizarla en la colección.</li>
<li>callback: Una función de devolución de llamada que será invocada una vez que la operación de     modificación se complete, ya sea con éxito o con error. Esta función toma un parámetro que indica si ocurrió un error (Error | null).</li>
</ul>
<p><strong>Operación asincrona</strong>: Dentro de la función modificarCarta, se llama al método cargarColeccion. Esta es una operación asincrona que carga la colección de cartas del usuario desde un archivo. Se proporciona un callback a cargarColeccion, que será invocado una vez que la operación de carga se complete.</p>
<p><strong>Manejo de errores</strong>: Si hay un error al cargar la colección, se llama al callback de la función modificarCarta con el error correspondiente y se termina la ejecución de la función.</p>
<p><strong>Modificación de la carta</strong>: Si la carga de la colección se realiza con éxito, se busca la carta en la colección utilizando el id proporcionado. Si se encuentra la carta, se actualiza con la nueva información (nuevaCarta).</p>
<p><strong>Guardado de la colección</strong>: Después de actualizar la carta en la colección, se llama al método guardarColeccion. Al igual que cargarColeccion, esta es una operación asincrónica que guarda la colección modificada en un archivo. Se proporciona un callback a guardarColeccion, que será invocado una vez que la operación de guardado se complete.</p>
<p><strong>Llamada al callback principal</strong>: Dentro del callback de guardarColeccion, se verifica si ocurrió algún error. Si es así, se llama al callback principal de la función modificarCarta con el error correspondiente. Si la operación se realizó con éxito, se llama al callback principal con null, indicando que la operación de modificación se completó correctamente.</p>
<p>Después, en el servidor se implementaron los siguientes elementos claves:</p>
<p><strong>Clase CartaManager</strong>:</p>
<pre><code class="language-typescript"><span class="hl-1">/**</span><br/><span class="hl-1"> * </span><span class="hl-2">@brief</span><span class="hl-1"> Clase CartaManager</span><br/><span class="hl-1"> * </span><span class="hl-2">@details</span><span class="hl-1"> Clase para gestionar las operaciones de las cartas</span><br/><span class="hl-1"> */</span><br/><span class="hl-2">class</span><span class="hl-0"> </span><span class="hl-5">CartaManager</span><span class="hl-0"> </span><span class="hl-2">extends</span><span class="hl-0"> </span><span class="hl-5">EventEmitter</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-1">/**</span><br/><span class="hl-1">   * </span><span class="hl-2">@brief</span><span class="hl-1"> Constructor de la clase CartaManager</span><br/><span class="hl-1">   * </span><span class="hl-2">@details</span><span class="hl-1"> Constructor de la clase CartaManager</span><br/><span class="hl-1">   */</span><br/><span class="hl-0">  </span><span class="hl-2">constructor</span><span class="hl-0">() {</span><br/><span class="hl-0">    </span><span class="hl-2">super</span><span class="hl-0">();</span><br/><span class="hl-0">  }</span>
</code><button>Copy</button></pre>
<ul>
<li>Esta clase extiende EventEmitter y se encarga de gestionar las operaciones relacionadas con las cartas, como agregar, listar, mostrar, modificar y eliminar cartas.  </li>
<li>Cada método de esta clase recibe un objeto net.Socket (que representa al cliente) y un array de argumentos que contiene los datos necesarios para realizar la operación correspondiente.</li>
</ul>
<p><strong>Creación del servidor TCP</strong>:</p>
<pre><code class="language-typescript"><span class="hl-1">// Creamos el servidor</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">server</span><span class="hl-0"> = </span><span class="hl-3">net</span><span class="hl-0">.</span><span class="hl-4">createServer</span><span class="hl-0">((</span><span class="hl-3">socket</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-3">chalk</span><span class="hl-0">.</span><span class="hl-4">green</span><span class="hl-0">(</span><span class="hl-9">&quot;Cliente conectado.&quot;</span><span class="hl-0">));</span><br/><span class="hl-0">  </span><span class="hl-2">let</span><span class="hl-0"> </span><span class="hl-3">usuario</span><span class="hl-0">: </span><span class="hl-5">string</span><span class="hl-0"> | </span><span class="hl-5">undefined</span><span class="hl-0">;</span><br/><br/><span class="hl-0">  </span><span class="hl-1">// Manejamos los datos recibidos del cliente</span><br/><span class="hl-0">  </span><span class="hl-3">socket</span><span class="hl-0">.</span><span class="hl-4">on</span><span class="hl-0">(</span><span class="hl-9">&quot;data&quot;</span><span class="hl-0">, (</span><span class="hl-3">data</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">    </span><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">mensaje</span><span class="hl-0"> = </span><span class="hl-3">data</span><span class="hl-0">.</span><span class="hl-4">toString</span><span class="hl-0">().</span><span class="hl-4">trim</span><span class="hl-0">();</span><br/><span class="hl-0">    </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-3">chalk</span><span class="hl-0">.</span><span class="hl-4">yellow</span><span class="hl-0">(</span><span class="hl-9">&quot;Mensaje recibido del cliente:&quot;</span><span class="hl-0">), </span><span class="hl-3">mensaje</span><span class="hl-0">);</span><br/><br/><span class="hl-0">    </span><span class="hl-6">if</span><span class="hl-0"> (!</span><span class="hl-3">usuario</span><span class="hl-0">) {</span><br/><span class="hl-0">      </span><span class="hl-3">usuario</span><span class="hl-0"> = </span><span class="hl-3">mensaje</span><span class="hl-0">;</span><br/><span class="hl-0">      </span><span class="hl-3">connectedUsers</span><span class="hl-0">.</span><span class="hl-4">set</span><span class="hl-0">(</span><span class="hl-3">usuario</span><span class="hl-0">, </span><span class="hl-3">socket</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-3">socket</span><span class="hl-0">.</span><span class="hl-4">write</span><span class="hl-0">(</span><span class="hl-9">`Bienvenido, </span><span class="hl-2">${</span><span class="hl-3">usuario</span><span class="hl-2">}</span><span class="hl-9">!</span><span class="hl-10">\n</span><span class="hl-9">`</span><span class="hl-0">);</span><br/><span class="hl-0">      </span><span class="hl-6">return</span><span class="hl-0">;</span><br/><span class="hl-0">    }</span><br/><br/><span class="hl-0">    </span><span class="hl-1">// Procesamos el comando recibido</span><br/><span class="hl-0">    </span><span class="hl-3">cartaManager</span><span class="hl-0">.</span><span class="hl-4">procesarComando</span><span class="hl-0">(</span><span class="hl-3">socket</span><span class="hl-0">, </span><span class="hl-3">mensaje</span><span class="hl-0">);</span><br/><span class="hl-0">  });</span>
</code><button>Copy</button></pre>
<ul>
<li>Se crea el servidor mediante net.createServer().</li>
<li>Cuando se establece una conexión con un cliente, se ejecuta una función de devolución de llamada que recibe un objeto net.Socket representando al cliente.</li>
<li>En esta función de devolución de llamada, se inicializa una variable usuario que almacenará el nombre del usuario conectado.</li>
</ul>
<p><strong>Manejo de eventos del cliente</strong>:</p>
<ul>
<li>Cuando se recibe un mensaje del cliente a través del evento &quot;data&quot; del socket, se procesa el mensaje y se decide si se trata del nombre de usuario o de un comando relacionado con las cartas.</li>
<li>Si es el nombre de usuario, se almacena en la variable usuario y se agrega al mapa connectedUsers.</li>
<li>Si es un comando, se pasa al método procesarComando() de CartaManager para su procesamiento.</li>
</ul>
<p><strong>Manejo de desconexión del cliente</strong>:</p>
<ul>
<li>Cuando se cierra la conexión con el cliente a través del evento &quot;close&quot; del socket, se elimina el usuario del mapa connectedUsers y se muestra un mensaje en la consola indicando que el cliente se ha desconectado.</li>
</ul>
<p><strong>Manejo de errores</strong>:</p>
<ul>
<li>Se añade un manejador de eventos para el evento &quot;error&quot; del socket, que muestra un mensaje en la consola en caso de error de conexión.</li>
</ul>
<p><strong>Inicio del servidor</strong>:</p>
<ul>
<li>El servidor comienza a escuchar en el puerto 3000 mediante server.listen().</li>
<li>Cuando el servidor está escuchando, se muestra un mensaje en la consola indicando el puerto en el que está escuchando.</li>
</ul>
<p>En en el fichero del cliente, se implentaron los siguientes conceptos claves:</p>
<pre><code class="language-typescript"><span class="hl-1">// Obtener argumentos de la línea de comandos</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">argv</span><span class="hl-0"> = </span><span class="hl-4">yargs</span><span class="hl-0">(</span><span class="hl-4">hideBin</span><span class="hl-0">(</span><span class="hl-3">process</span><span class="hl-0">.</span><span class="hl-3">argv</span><span class="hl-0">)).</span><span class="hl-3">argv</span><span class="hl-0">;</span>
</code><button>Copy</button></pre>
<p><strong>Obtención de argumentos de la línea de comandos</strong>:</p>
<p>Se utiliza yargs para procesar los argumentos de la línea de comandos y se almacenan en argv.</p>
<pre><code class="language-typescript"><span class="hl-1">// Crear un socket para la conexión con el servidor</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-7">client</span><span class="hl-0"> = </span><span class="hl-2">new</span><span class="hl-0"> </span><span class="hl-3">net</span><span class="hl-0">.</span><span class="hl-4">Socket</span><span class="hl-0">();</span>
</code><button>Copy</button></pre>
<p><strong>Creación del socket del cliente</strong>:</p>
<p>Se crea un nuevo socket TCP para la conexión con el servidor mediante net.Socket().</p>
<pre><code class="language-typescript"><span class="hl-1">// Conectar al servidor en el puerto 3000</span><br/><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-4">connect</span><span class="hl-0">(</span><span class="hl-8">3000</span><span class="hl-0">, </span><span class="hl-9">&quot;localhost&quot;</span><span class="hl-0">, () </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-9">&quot;Conectado al servidor&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<p><strong>Conexión al servidor</strong>:</p>
<p>El cliente se conecta al servidor en el puerto 3000 en localhost mediante client.connect().</p>
<pre><code class="language-typescript"><span class="hl-1">// Enviar datos al servidor cuando el usuario ingrese un comando</span><br/><span class="hl-3">process</span><span class="hl-0">.</span><span class="hl-3">stdin</span><span class="hl-0">.</span><span class="hl-4">on</span><span class="hl-0">(</span><span class="hl-9">&quot;data&quot;</span><span class="hl-0">, (</span><span class="hl-3">data</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-4">write</span><span class="hl-0">(</span><span class="hl-3">data</span><span class="hl-0">.</span><span class="hl-4">toString</span><span class="hl-0">().</span><span class="hl-4">trim</span><span class="hl-0">());</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<p><strong>Envío de datos al servidor</strong>:</p>
<p>Se utiliza process.stdin.on(&quot;data&quot;) para escuchar la entrada de datos desde la línea de comandos.
Cuando el usuario ingresa un comando y presiona Enter, los datos se envían al servidor utilizando client.write().</p>
<pre><code class="language-typescript"><span class="hl-1">// Manejar los datos recibidos del servidor</span><br/><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-4">on</span><span class="hl-0">(</span><span class="hl-9">&quot;data&quot;</span><span class="hl-0">, (</span><span class="hl-3">data</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-9">&quot;Respuesta del servidor:&quot;</span><span class="hl-0">, </span><span class="hl-3">data</span><span class="hl-0">.</span><span class="hl-4">toString</span><span class="hl-0">().</span><span class="hl-4">trim</span><span class="hl-0">());</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<p><strong>Manejo de datos recibidos del servidor</strong>:</p>
<p>Se utiliza client.on(&quot;data&quot;) para manejar los datos recibidos del servidor.
Cuando se recibe un mensaje del servidor, se muestra en la consola.</p>
<pre><code class="language-typescript"><span class="hl-1">// Manejar la conexión cerrada por el servidor</span><br/><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-4">on</span><span class="hl-0">(</span><span class="hl-9">&quot;close&quot;</span><span class="hl-0">, () </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">log</span><span class="hl-0">(</span><span class="hl-9">&quot;Conexión cerrada&quot;</span><span class="hl-0">);</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<p><strong>Manejo de conexión cerrada por el servidor</strong>:</p>
<p>Se utiliza client.on(&quot;close&quot;) para manejar el evento de conexión cerrada por el servidor.
Cuando se cierra la conexión, se muestra un mensaje en la consola.</p>
<pre><code class="language-typescript"><span class="hl-1">// Manejar errores de conexión</span><br/><span class="hl-3">client</span><span class="hl-0">.</span><span class="hl-4">on</span><span class="hl-0">(</span><span class="hl-9">&quot;error&quot;</span><span class="hl-0">, (</span><span class="hl-3">error</span><span class="hl-0">) </span><span class="hl-2">=&gt;</span><span class="hl-0"> {</span><br/><span class="hl-0">  </span><span class="hl-3">console</span><span class="hl-0">.</span><span class="hl-4">error</span><span class="hl-0">(</span><span class="hl-9">&quot;Error de conexión:&quot;</span><span class="hl-0">, </span><span class="hl-3">error</span><span class="hl-0">);</span><br/><span class="hl-0">});</span>
</code><button>Copy</button></pre>
<p><strong>Manejo de errores de conexión</strong>:
Se utiliza client.on(&quot;error&quot;) para manejar los errores de conexión.
Si se produce un error durante la conexión, se muestra un mensaje en la consola.</p>
<a id="md:ejercicio-clase" class="tsd-anchor"></a><h1><a href="#md:ejercicio-clase">Ejercicio clase</a></h1><p>Durante la sesión de prácticas se planteó modificar una función para implementarla siguiendo el patrón de callback. Después, se sustituyó la invocación de métodos del API síncrona de Node.js de gestión el sistema de ficheros, por llamadas a los métodos equivalentes del API asíncrona basada en callback. Tambíen había que realizar pruebas del método asíncrono.</p>
<p>Modifiqué el método modificar carta, al añadir el patrón callback a este método tuve que mofidicar otros tambíen, como el método añadir carta, eliminar carta, listar cartas y mostrar carta, guardar coleccióm y cargar colección.</p>
<p>Tuve un error, porque solo tuve en cuenta los mensaje de error, pero no los mensajes de éxito. Por último, no me dió tiempo a realizar las pruebas de los métodos asíncronos.</p>
<a id="md:conclusión" class="tsd-anchor"></a><h1><a href="#md:conclusión">Conclusión</a></h1><p>La práctica proporciona una oportunidad para implementar una aplicación cliente-servidor robusta, capaz de gestionar colecciones de cartas Magic de múltiples usuarios de manera eficiente y segura. La adopción de herramientas modernas y metodologías de desarrollo sólidas garantiza la calidad y fiabilidad del software desarrollado.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:práctica-10---aplicación-cliente-servidor-para-coleccionistas-de-cartas-magic"><span>Práctica 10 -<wbr/> <wbr/>Aplicación cliente-<wbr/>servidor para coleccionistas de cartas <wbr/>Magic</span></a><a href="#md:introducción"><span>Introducción</span></a><a href="#md:desarrollo"><span>Desarrollo</span></a><ul><li><a href="#md:consideraciones-de-implementación"><span>Consideraciones de <wbr/>Implementación:</span></a></li></ul><a href="#md:ejercicio-clase"><span>Ejercicio clase</span></a><a href="#md:conclusión"><span>Conclusión</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>ull-esit-inf-dsi-23-24-prct10-fs-proc-sockets-magic-app-inesgarrote</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>